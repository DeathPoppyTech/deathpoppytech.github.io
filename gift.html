<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Gift User</title>
<link rel="stylesheet" href="style.css">
</head>
<body>
<div id="content" class="container">Loading...</div>
<script>
async function main() {
  const corsProxy = "https://api.allorigins.win/raw?url=";
  const params = new URLSearchParams(window.location.search);
  const username = params.get("user");
  const content = document.getElementById("content");
  if (!username) {
    content.innerHTML = "<p>‚ùå No username provided. <a href='index.html'>Go back</a></p>";
    return;
  }
  content.innerHTML = `<p>üîç Searching for <b>${username}</b>...</p>`;
  try {
    const userRes = await fetch("https://users.roblox.com/v1/usernames/users", {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({ usernames: [username] })
    });
    const userData = await userRes.json();
    const user = userData.data?.[0];
    if (!user) {
      content.innerHTML = "<p>‚ùå User not found. <a href='index.html'>Try again</a></p>";
      return;
    }
    const userId = user.id;
    const displayName = user.displayName || user.name;
    const avatar = `https://www.roblox.com/headshot-thumbnail/image?userId=${userId}&width=180&height=180&format=png`;
    const clothingRes = await fetch(corsProxy + encodeURIComponent(`https://www.roblox.com/users/inventory/list-json?userId=${userId}&assetTypeId=11`));
    const clothing = await clothingRes.json();
    const passRes = await fetch(corsProxy + encodeURIComponent(`https://www.roblox.com/users/inventory/list-json?userId=${userId}&assetTypeId=34`));
    const passes = await passRes.json();
    let html = `
      <div class="profile">
        <img src="${avatar}" width="120" height="120">
        <h1>${displayName} (@${user.name})</h1>
        <p>User ID: ${userId}</p>
        <a href="index.html" class="back">‚Üê Search another user</a>
      </div>
      <h2>üéüÔ∏è Gamepasses</h2>
      <div class="items">
    `;
    if (passes.Data && passes.Data.Items && passes.Data.Items.length) {
      for (const p of passes.Data.Items) {
        html += `
          <div class="item">
            <img src="${p.Thumbnail.Url}" alt="${p.Name}">
            <p>${p.Name}</p>
            <a href="https://www.roblox.com/game-pass/${p.Item.AssetId}" target="_blank"><button>Buy</button></a>
          </div>
        `;
      }
    } else html += "<p>No gamepasses found.</p>";
    html += "</div><h2>üëï Clothing</h2><div class='items'>";
    if (clothing.Data && clothing.Data.Items && clothing.Data.Items.length) {
      for (const item of clothing.Data.Items) {
        html += `
          <div class="item">
            <img src="${item.Thumbnail.Url}" alt="${item.Name}">
            <p>${item.Name}</p>
            <a href="https://www.roblox.com/catalog/${item.Item.AssetId}" target="_blank"><button>Buy</button></a>
          </div>
        `;
      }
    } else html += "<p>No clothing found.</p>";
    html += "</div>";
    content.innerHTML = html;
  } catch {
    content.innerHTML = `<p>‚ö†Ô∏è Failed to load data. Please try again later.</p>`;
  }
}
main();
</script>
</body>
</html>
